#!/bin/sh
NAME=$1
TYPE=$2
FILE=$3
if [ -r "$FILE" ]
then SOURCEEXP="file=@$FILE"
elif [ `echo $FILE | grep '^http'` ]
then SOURCEEXP="contentURL=$FILE"
else SOURCEEXP="ILLEGAL SOURCE"
echo "No input found: $2"
exit 0
fi

echo "$NAME, $TYPE, $FILE --> \c"
curl -Ss -X PUT 'https://mscr-test.rahtiapp.fi/datamodel-api/v2/schemaFull' --header 'Accept: */*' --header 'User-Agent: Thunder Client (https://www.thunderclient.com)' --header 'Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIwYjNiNjZmZS1iMWY4LTQ1YTctYmVjNi02YmQ3ZjAxM2I5OTciLCJleHAiOjE3MjgwNDc2NzQsImlhdCI6MTcxMjIzNjQ3NH0.CWHiJhpY13raAnWo2ZV8TpJl6pD-DAugYBg-JqgD_jVID8IGlNfvjPZNl3EUQ6ro-lRnRwEmgL6TYBBS3pHcmw' --form metadata="{ \"status\": \"DRAFT\", \"state\": \"DRAFT\", \"visibility\": \"PUBLIC\", \"namespace\": \"http://test.com\", \"versionLabel\": \"1\", \"label\": { \"en\": \"$NAME\" }, \"description\": { \"en\": \"string\" } , \"languages\": [\"en\"], \"format\": \"$TYPE\" }" --form $SOURCEEXP | jq -r '[.title, .status, .error, .detail, .pid]|@tsv'

